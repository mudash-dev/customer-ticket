
generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

//1. Ticket State

enum Status{
  OPEN
  STARTED
  IN_REVIEW
  CLOSED
}
enum Priority{
  LOW
  MEDIUM
  HIGH
  URGENT
}

//2. User Model

model User {
  id      String   @id @default(cuid())
  name    String?  
  email   String   @unique
  role    Role     @default(USER)


// Relationships
  createdTickets    Ticket[]  @relation("Customer")
  assignedTickets   Ticket[]  @relation("Agent")

  createdAt   DateTime    @default(now())
}
enum Role {
  USER
  ADMIN
  AGENT
}

//3 Ticket Model

model Ticket {
  id            String    @id @default(cuid())
  title         String
  description   String    // use this @db.Text in posygresql
  Status        Status    @default(OPEN)
  Priority      Priority  @default(MEDIUM)

  //Who opened ticket?eg customer
  customerId    String
  customer      User      @relation("Customer", fields: [customerId], references: [id])

  // Staff handling ticket
  agentId     String?
  agent       User?   @relation("Agent", fields: [agentId], references: [id]) 

  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}